%div{ "data-controller": "trip-show" }
  - plan_groups.each_with_index do |(start_date, plans), index|
    .plan-group
      %button.roamio-header.btn.collapse-btn.px-0.py-2.w-100.text-uppercase.text-start.fs-5{
        type: "button",
        data: {
          bs_toggle: "collapse",
          bs_target: "#plans#{index}",
        },
        aria: {
          expanded: "false",
          controls: "plans#{index}",
        },
      }
        = start_date.strftime("%A %d %b %Y")
        %i.bi.bi-chevron-up.float-end

      .collapse.show.mb-3{ id: "plans#{index}" }
        - plans.each do |plan|
          .row.mb-2{ id: "plan-#{plan.id}" }
            .col-sm-2
              %p.mb-0.fw-semibold.fs-5.text-body-secondary= plan.start_date.strftime("%H:%M")

            - swiper_class = plan.backup_plan.present? ? "swiper trip-carousel-#{plan.id}" : nil

            .col{ class: swiper_class }
              - if swiper_class
                .swiper-wrapper.p-0.overflow-hidden
                  .swiper-slide
                    = render_plan_partial(plan, trip)

                  .swiper-slide
                    = render_plan_partial(plan.backup_plan.decorate, trip)

              - else
                = render_plan_partial(plan, trip)
